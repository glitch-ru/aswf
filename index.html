<!doctype html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Сокращатель</title>
</head>
<body>
<script>
async function run() {
    const params = new URLSearchParams(location.search);
    const code = params.get("c");

    if (!code) {
        document.body.innerHTML = "<h2>Укажите параметр ?c=код</h2>";
        return;
    }

    try {
        const response = await fetch("db.json?_=" + Date.now()); // анти-кеш
        const db = await response.json();

        if (db[code]) {
            location.href = db[code];
        } else {
            document.body.innerHTML = "<h2>Код не найден</h2>";
        }
    } catch (e) {
        document.body.innerHTML = "<h2>Ошибка загрузки базы</h2>";
    }
}

run();
</script>
</body>
</html>
