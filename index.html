<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Перенаправление...</title>
</head>
<body>
<script>
(async () => {
  const code = location.pathname.slice(1);

  if (!code) {
    document.body.textContent = "Нужен параметр CODE";
    return;
  }

  const res = await fetch("db.json?_=" + Date.now());
  const db = await res.json();

  if (db[code]) {
    const params = location.search;
    const hash   = location.hash;

    location.href = db[code] + params + hash;
  } else {
    document.body.textContent = "Код " + code + " не найден";
  }
})();
</script>
</body>
</html>
